float data[800]={-221.545324,-232.6856787,-241.1451328,-246.4026453,-250.5699639,-252.7755994,-252.994037,-252.8586921,-249.2709368,-245.5162065,-240.3048294,-235.1908993,-229.3507237,-224.0102722,-219.3534023,-216.4670801,-212.8978556,-209.461089,-209.7012301,-210.8991005,-210.9327861,-211.570921,-213.6273361,-216.8699103,-218.5756159,-223.0436601,-225.3761164,-228.6970658,-232.454753,-235.9612308,-237.7088671,-240.6909453,-244.0966102,-246.1147239,-248.1551881,-240.528976,-219.5746046,-186.2283826,-150.6178721,-107.0096649,-63.58736488,-28.02215109,0.141753929,31.13270317,56.35299929,53.08345405,34.01133995,7.532466987,-19.63036585,-50.14453409,-78.01523177,-102.8231085,-123.8422389,-143.2915878,-161.561087,-177.910523,-191.268142,-204.0285687,-213.7472885,-221.5666868,-230.2063797,-233.813994,-238.804173,-239.9433733,-241.2779047,-239.5220584,-237.4583309,-233.0664636,-226.6912521,-220.7126521,-215.8358283,-213.8820376,-209.1412524,-206.9119343,-205.9910386,-203.7672955,-204.3810327,-204.7778261,-205.339082,-208.8662699,-211.1056099,-212.1324374,-215.9300707,-218.0053547,-220.3943063,-221.7875219,-228.0360617,-229.307959,-235.510136,-239.4988383,-243.0907189,-245.7221813,-240.6083018,-220.5496961,-190.5102543,-154.6293594,-113.5254583,-69.22284432,-32.90689775,-0.486741545,32.18399224,55.80997687,53.65910458,36.34752021,9.708094786,-18.82937221,-48.28791753,-74.27139853,-99.7820185,-122.0983994,-140.4999452,-159.1651489,-175.3311601,-189.5141278,-203.2939025,-212.3732344,-220.720482,-227.2937237,-234.0939563,-236.6915465,-239.2738981,-239.0471069,-236.7998759,-233.0200749,-228.8107202,-224.5449046,-217.894557,-213.1554537,-210.2018272,-205.0045354,-202.6025505,-200.3734429,-198.8666658,-198.2239571,-198.3142389,-200.9018767,-202.2035226,-204.6958413,-207.2496187,-210.8209079,-216.390349,-218.8384349,-224.0157901,-227.1957606,-230.7749606,-233.4370255,-235.6293766,-239.7414745,-237.9411203,-223.6638571,-196.0612235,-161.225805,-123.0678184,-83.74258421,-46.68351717,-11.30094722,21.07325862,46.49265579,51.17403101,34.96394874,9.726815327,-17.30751894,-46.5868065,-73.6982246,-99.93617095,-123.1970847,-142.250578,-160.1452538,-177.7022234,-191.2328215,-204.5346995,-215.6085382,-223.6961821,-232.4182429,-238.1938097,-239.8545006,-241.1626985,-239.462888,-238.1758119,-235.5102887,-231.3950249,-229.164317,-224.4314407,-220.8134858,-215.991309,-211.4849319,-208.4519463,-207.5730275,-204.9846371,-204.0485865,-205.6347823,-204.480864,-207.274339,-208.1083569,-211.0578844,-213.3314268,-215.7746207,-217.5092836,-219.5255239,-220.0288887,-224.164876,-225.7732938,-227.7161511,-228.9600298,-226.3350447,-214.159357,-190.335199,-162.3986407,-131.142851,-98.35721133,-67.28791425,-37.08843822,-7.461998261,16.36921956,25.14267398,19.61934123,5.544547016,-13.24869207,-36.45829553,-58.4071461,-78.70624952,-98.39841053,-116.2071281,-134.7788094,-152.2026462,-165.1704921,-174.7105576,-182.0121713,-190.0334215,-195.4747397,-198.4894845,-198.6435891,-199.0526592,-198.7081729,-196.9227577,-193.19937,-191.9654147,-188.6063186,-183.5737736,-182.7880422,-181.5515226,-180.7428098,-179.7122383,-180.5158016,-181.1678341,-182.0738738,-183.993827,-186.9268442,-189.3444607,-190.6187629,-193.8823663,-195.1111809,-196.8060486,-200.1074927,-202.7062781,-204.649072,-208.3374703,-210.7455423,-212.6308832,-207.0113437,-192.6739491,-172.973231,-149.5023905,-122.0728295,-91.85771396,-58.41008245,-24.86167414,5.372999744,25.55482108,33.57762516,32.25926365,23.83102498,10.80882547,-5.921816557,-23.86873087,-40.18287892,-56.06478892,-72.88280452,-88.68481523,-103.623864,-117.561582,-130.8403429,-142.0141935,-150.6104889,-158.4372477,-164.4351803,-167.9430714,-169.9009456,-169.9740628,-169.0895005,-167.3761042,-164.3229031,-162.176486,-159.4918803,-157.8836651,-157.5943287,-158.1135834,-158.2016943,-158.5707277,-159.3277519,-161.7454741,-163.29182,-164.2426965,-166.7497745,-167.7879986,-172.5690979,-175.7250702,-178.8023397,-181.1133807,-186.0217347,-188.3429888,-191.0339214,-193.7153246,-193.701434,-185.7365471,-164.9954211,-139.8271319,-109.7546874,-74.80628456,-35.50383398,4.025363042,36.72147552,56.84573296,63.62278541,59.84816896,47.96792277,32.90257467,13.21776278,-6.755766437,-26.85043249,-44.11619014,-61.30991568,-75.70595571,-90.48859078,-104.2592288,-118.2944396,-129.1642604,-138.3177313,-145.9357486,-152.5544368,-157.0736901,-160.4234327,-162.943836,-164.4404992,-162.7031514,-162.1227772,-161.7039056,-161.1476737,-159.8500287,-158.8278452,-159.8763453,-158.5820769,-157.7976472,-159.6426444,-163.0110687,-165.4225599,-169.267455,-172.6992594,-179.4581818,-184.2083016,-188.308747,-192.1241091,-194.5884855,-196.7993475,-199.0749886,-202.571604,-204.2453367,-207.4862211,-207.0921789,-202.8603716,-189.661913,-166.0762104,-138.8091013,-110.0312292,-75.6439858,-39.66873543,-2.648674921,25.19375291,39.81706071,44.93389755,39.25866493,31.43775711,17.97337941,2.42559141,-11.290451,-27.23335899,-41.20097711,-56.3407485,-69.66714652,-83.44668508,-94.01934585,-102.1155089,-109.7173877,-115.9996233,-119.93455,-122.1598646,-124.0810366,-124.3739156,-124.2584047,-120.8703994,-117.0788223,-113.0779785,-111.2836346,-111.9294028,-111.7920661,-111.8836287,-114.2343726,-117.3807659,-116.825642,-117.7613839,-120.0521629,-123.8723097,-128.6183188,-136.1100936,-140.0944752,-144.2910398,-151.3865626,-155.6655051,-160.074539,-162.0809232,-164.3862212,-164.5348467,-166.6151103,-168.3609894,-167.2217488,-159.0312137,-146.5801759,-130.1569506,-112.365373,-91.80504843,-68.48497193,-48.02568286,-31.69752449,-20.0792782,-14.73523255,-13.7877067,-16.05868147,-21.12107798,-27.31140615,-35.80182618,-44.92426545,-54.64205983,-63.60916277,-74.55075503,-86.96930749,-97.07777925,-108.8688018,-120.0644059,-128.186156,-134.4659795,-134.7113654,-131.5703295,-125.3232872,-118.4231384,-109.9462962,-100.7892951,-93.36487503,-88.28647645,-84.1449846,-84.18298553,-86.41134657,-87.98121537,-90.23509802,-91.20714487,-92.60715746,-94.35027306,-97.16305631,-96.25781843,-95.66584228,-95.64217738,-96.94256644,-98.09779972,-100.2810612,-102.3684857,-104.4926534,-107.0350471,-112.1669615,-117.9381383,-123.2329563,-127.6728274,-127.6569514,-116.5669467,-91.44588933,-55.75001233,-11.13904272,34.85704146,76.29770177,105.9153871,123.0482353,125.0469095,116.5013324,98.10533235,75.86027272,49.87795248,26.94203214,5.614615539,-16.53069087,-36.52848806,-55.85078561,-74.83760257,-91.45257617,-107.3149193,-119.7955065,-125.4340156,-134.1580189,-138.5001521,-144.9918414,-149.4735503,-150.9578221,-150.5048982,-145.3822907,-139.3419513,-128.4061244,-122.6796828,-114.2951037,-108.5128249,-107.7849108,-108.5212,-110.5170997,-115.2255556,-119.5571604,-121.7675518,-127.6183437,-133.0933358,-138.9181101,-143.7576227,-147.2059352,-150.2633633,-151.5240848,-151.0220226,-149.8689622,-148.2616017,-150.4563227,-150.9834166,-152.9057732,-153.8195324,-148.7534694,-136.6619969,-108.9679212,-68.48148605,-17.28281303,37.00568861,85.53945766,120.8047284,136.7095533,135.4371122,119.0779613,93.34879857,62.75408595,31.47966426,2.906638785,-24.57333611,-49.10332246,-72.03885965,-90.63890947,-108.6369973,-124.0292207,-137.739843,-148.5909204,-156.7420691,-161.1879384,-165.0206563,-165.5560252,-164.1421714,-161.3497778,-158.4741377,-152.8570245,-144.5483989,-134.6328179,-126.4957491,-118.9905793,-114.240359,-110.2547495,-108.4611427,-111.1333492,-114.1187978,-117.5467965,-123.9417325,-130.2120731,-134.220806,-137.2661231,-139.8634272,-140.0585443,-141.9965317,-142.9027166,-142.3382086,-146.3631691,-154.3484285,-159.0338705,-168.6119501,-176.1860187,-178.9707984,-185.4874137,-185.9428373,-171.0358983,-149.1198138,-124.7764656,-95.30787751,-64.42756184,-39.29279316,-20.47169467,-5.896892366,0.951094924,-9.197997865,-23.84020622,-34.76833954,-21.92180737,-21.26744975,-56.23113923,-74.19212687,-82.34227521,-102.6979126,-116.5308184,-124.6305513,-137.925421,-149.5846541,-154.3092256,-158.5212162,-162.0435119,-164.4927596,-165.6540846,-164.7305625,-162.4186432,-160.1009389,-157.487888,-154.4658146,-151.1556607,-148.3764532,-147.5183037,-149.2702439,-150.5696584,-149.3520402,-152.7848077,-155.0615094,-155.0529202,-159.2138183,-161.2939702,-164.3778393,-169.0276839,-171.3805697,-173.784345,-178.039208,-177.2476172,-179.4519221,-180.3479671,-182.6305414,-184.838752,-187.0093031,-187.9523809,-188.3841152,-179.9530601,-159.5947274,-130.7417107,-98.29391294,-61.70564547,-27.72284303,-2.236248264,13.0375613,19.84975769,17.73367507,8.481335286,-6.843770529,-28.37565191,-49.00512992,-70.07396867,-93.62510924,-115.5583158,-132.5410831,-150.3048078,-166.8602528,-178.3374412,-188.558553,-196.391362,-199.2259689,-200.607464,-201.4762389,-199.5093215,-194.784968,-189.7114859,-180.2250753,-171.4062436,-164.7036445,-158.3806753,-152.8251677,-150.4820113,-148.4808044,-149.2961757,-150.3611574,-152.141758,-155.2928137,-157.5649291,-161.7858866,-164.4487759,-167.70713,-171.6555216,-174.5641428,-176.6325662,-180.5078413,-184.7425984,-189.0113489,-191.4459828,-196.9194589,-201.5437878,-205.2166082,-206.7610933,-205.3599899,-193.4704915,-169.1806267,-132.9487819,-94.83468903,-54.31744938,-21.49961076,2.725950356,16.1386592,18.60514177,9.840918657,-6.519267535,-28.74292532,-56.04121435,-81.71080197,-107.6536566,-130.4810717,-152.2726558,-168.4124923,-182.7059995,-196.0738216,-205.188248,-211.2369811,-214.9083702,-215.4882122,-212.0772409,-207.9904984,-203.086264,-195.2467416,-188.6938656,-181.1137894,-173.8573912,-165.5444464,-157.1317034,-149.7718142,-143.5153105,-140.6212225,-139.5951354,-141.2140504,-143.3190339,-146.7301913,-152.7041063,-155.4028074,-160.6843589,-165.0697877,-170.3200804,-175.4847686,-179.9524838,-185.0434563,-187.9401478,-191.9587679,-197.409368,-202.4855469,-204.8115029,-207.1575737,-206.8596925,-195.3651313,-170.941381,-137.5688984,-96.83465208,-51.66296433,-12.29905374,16.90685613,34.65703289,40.59182701,32.773387,14.12097414,-12.19791319,-39.92275423,-69.49526736,-98.60751314,-127.2131266,-151.1211146,-171.467746,-190.3509715,-205.2094754,-216.6863861,-225.6684337,-229.5882563,-230.8645487,-229.0002271,-224.7889112,-217.1104827,-208.80604,-196.0064001,-184.1014827,-172.983293,-162.8791347,-153.7652206,-145.6045613,-144.3366156,-142.1507718,-147.8760773,-147.8695744,-160.7702112};
float filtered[800]={0};
int len=800;

void normalize(float* sig,int len){
  float maxm=-100000;
  for(int i=0;i<len;i++)
  {
    if(maxm<sig[i])
    maxm=sig[i];
    }
    maxm=abs(maxm);
    for(int i=0;i<len;i++)
    {
      sig[i]=sig[i]/maxm;
      }
  }
  
void setup() {
  Serial.begin(9600);
  // put your setup code here, to run once:
  filtered[0]=0;
  float g=0.98429;float r=0.96858;
  for(int i=2;i<len;i++)
  {
    //filtered[i]=g*(data[i]-data[i-1])-r*filtered[i-1];
    //Band pass till 10Hz
    filtered[i]=(data[i]-data[i-2]+2.6728*filtered[i-1]-1.7544*filtered[i-2])/2.7933;
    }
    normalize(filtered,len);
    normalize(data,len);
}

void loop() {
  // put your main code here, to run repeatedly:
  for(int i=0;i<len;i++)
  {
    Serial.print(data[i]);
    Serial.print(',');
    Serial.println(filtered[i])+5;
    }
}
